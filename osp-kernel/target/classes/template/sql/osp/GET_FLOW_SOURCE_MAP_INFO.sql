SELECT
    T1.ORDER_M_ID,
    T1.POOL_KEY,
    T1.EXPECT_PROCESS_TIME,
    T1.SRC_CREATE_DT_STR,
    T1.SRC_CREATE_TIME_STR,
    T3.KPI_DAY_TYPE,
    T3.CHK_CREATE_DATE, 
    REPLACE(T3.BEFORE_CREATE_DATE, ':', '') AS BEFORE_CREATE_DATE,
    T3.IS_REGULAR_TIME,
    T3.REGULAR_TIME,
    T3.START_COUNT_TIME
FROM
    (
        SELECT
            ORDER_M_ID,
            POOL_KEY,
            COUNTS,
            SOURCE_SYS_ID,
            SOURCE_PROD_TYPE_ID,
            TO_CHAR(EXPECT_PROCESS_TIME, 'yyyy-mm-dd hh24:mi:ss') AS EXPECT_PROCESS_TIME,
            TO_CHAR(SOURCE_CREATE_TIME, 'yyyy-mm-dd')             AS SRC_CREATE_DT_STR,
            TO_CHAR(SOURCE_CREATE_TIME, 'hh24mi')                 AS SRC_CREATE_TIME_STR
        FROM
            ORDER_MAIN_OSP
        WHERE
            SOURCE_ORDER_ID = :sourceOrderId
    ) T1
LEFT JOIN
    SYS_FLOW_SOURCE_MAP T2
ON
    (
        T1.COUNTS <= T2.LOWER_LIMIT_COUNTS
    AND T1.COUNTS >=T2.UPPER_LIMIT_COUNTS
    )
AND T1.SOURCE_SYS_ID = T2.SOURCE_SYS_ID
AND T1.SOURCE_PROD_TYPE_ID = T2.SOURCE_PROD_TYPE_ID
AND T2.IS_DEFAULT = 'Y'
LEFT JOIN
    SYS_ORDER_TYPE_SETTING T3
ON
    T2.ORDER_TYPE_ID = T3.ORDER_TYPE_ID
AND T2.ORDER_TYPE_NAME = T3.ORDER_TYPE_NAME
