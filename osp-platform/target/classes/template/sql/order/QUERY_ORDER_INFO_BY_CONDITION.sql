SELECT
    T1.ORDER_M_ID      AS ORDER_M_ID,
    T1.ORDER_TYPE_NAME AS ORDER_TYPE_NAME,
    (
        SELECT
            OPTIONS_TEXT
        FROM
            SYS_OPTIONS_REFERENCE
        WHERE
            OPTIONS_VALUE = T1.SOURCE_SYS_ID )  AS SOURCE_SYS_ID,
    T1.CRITICAL_FLAG                            AS CRITICAL_FLAG,
    NVL(T1.SOURCE_PROD_TYPE_NAME, ' ')          AS SOURCE_PROD_TYPE_NAME,
    NVL(T3.OPTIONS_TEXT, ' ')                   AS OPERATE_TYPE,
    NVL(T1.MSISDN, ' ')                         AS MSISDN,
    NVL(T1.CUST_NAME, ' ')                      AS CUST_NAME,
    T1.SOURCE_ORDER_ID                          AS SOURCE_ORDER_ID,
    NVL(T1.PARTENT_ORDER_ID, ' ')               AS PARTENT_ORDER_ID,
    T1.COUNTS                                   AS COUNTS,
    TO_CHAR(T1.CUST_SPECIFY_DATE, 'YYYY-MM-DD') AS CUST_SPECIFY_DATE,
    NVL(T2.STATUS_NAME, ' ')                    AS ORDER_STATUS,
    NVL(T1.PROCESS_USER_NAME, ' ')              AS PROCESS_USER_NAME,
    T1.EXPECT_PROCESS_TIME                      AS EXPECT_PROCESS_TIME,
    T1.EXPECT_COMPLETE_TIME                     AS EXPECT_COMPLETE_TIME,
    T1.SOURCE_CREATE_TIME                       AS SOURCE_CREATE_TIME,
    NVL(T1.PROCESS_RESULT, ' ')                 AS PROCESS_RESULT,
    NVL(T1.PROCESS_REASON, ' ')                 AS PROCESS_REASON,
    T4.LIGHT_COLOR                              AS LIGHT_COLOR,
    CASE
        WHEN (T1.EXPECT_COMPLETE_TIME - T5.OVERTIME / (24 * 60)) - SYSDATE < 0
        THEN 'Y'
        ELSE 'N'
    END AS OVERDUE_FLAG
FROM
    ORDER_MAIN_OSP T1
LEFT JOIN
    SYS_ORDER_STATUS_SETTING T2
ON
    T1.ORDER_STATUS = T2.STATUS_ID
LEFT JOIN
    SYS_OPTIONS_REFERENCE T3
ON
    T1.OPERATE_TYPE = T3.OPTIONS_VALUE
LEFT JOIN
    SYS_ORDER_STATUS_SETTING T4
ON
    T1.ORDER_STATUS=T4.STATUS_ID
LEFT JOIN
    SYS_ORDER_TYPE_SETTING T5
ON
    T1.ORDER_TYPE_ID = T5.ORDER_TYPE_ID
WHERE
    $P{CONDITION}